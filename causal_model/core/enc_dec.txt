import numpy as np

import torch
import torch.nn as nn
import torch.nn.functional as F
from networks import MLP

class CausalEncoder(nn.Module):
    def __init__(self, hidden_state_dim: int, feature_dim: int):
        super().__init__()
        self.hidden_state_dim = hidden_state_dim
        self.feature_dim = feature_dim

        # Feature Projection Layers
        self.tr_proj = MLP(self.hidden_state_dim, self.feature_dim, [self.hidden_state_dim//2],
                           activation=nn.SiLU)
        self.re_proj = MLP(self.hidden_state_dim, self.feature_dim, [self.hidden_state_dim//2],
                           activation=nn.SiLU)

    def forward(self, h):
        # Extract Features
        return{'tr_features': self.tr_proj(h), 're_features': self.re_proj(h)}
